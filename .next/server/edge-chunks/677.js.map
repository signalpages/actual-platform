{"version":3,"file":"edge-chunks/677.js","mappings":"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","sources":["webpack://_N_E/?142d","webpack://_N_E/?f30e","webpack://_N_E/?e3f2","webpack://_N_E/?bb73","webpack://_N_E/./components/ComparisonPicker.tsx","webpack://_N_E/./components/Layout.tsx","webpack://_N_E/./lib/dataBridge.client.ts","webpack://_N_E/./app/layout.tsx","webpack://_N_E/./app/globals.css"],"sourcesContent":["import(/* webpackMode: \"eager\", webpackExports: [\"default\"] */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\components\\\\Layout.tsx\");\n","import(/* webpackMode: \"eager\", webpackExports: [\"default\"] */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\components\\\\Layout.tsx\");\n","import(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\app-router.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\client-page.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\client-segment.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\error-boundary.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\http-access-fallback\\\\error-boundary.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\layout-router.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\render-from-template-context.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\router-reducer\\\\fetch-server-response.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\lib\\\\metadata\\\\metadata-boundary.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\shared\\\\lib\\\\app-router-context.shared-runtime.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\shared\\\\lib\\\\hooks-client-context.shared-runtime.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\shared\\\\lib\\\\server-inserted-html.shared-runtime.js\");\n","import(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\app-router.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\client-page.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\client-segment.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\error-boundary.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\http-access-fallback\\\\error-boundary.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\layout-router.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\render-from-template-context.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\client\\\\components\\\\router-reducer\\\\fetch-server-response.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\lib\\\\metadata\\\\metadata-boundary.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\shared\\\\lib\\\\app-router-context.shared-runtime.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\shared\\\\lib\\\\hooks-client-context.shared-runtime.js\");\n;\nimport(/* webpackMode: \"eager\" */ \"C:\\\\Users\\\\David B\\\\actual-fyi\\\\node_modules\\\\next\\\\dist\\\\esm\\\\shared\\\\lib\\\\server-inserted-html.shared-runtime.js\");\n","\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { listCategories, searchAssets, createProvisionalAsset } from '@/lib/dataBridge.client';\r\nimport { Asset, Category, ProductCategory } from '@/types';\r\n\r\nexport const AssetSelector: React.FC<{\r\n  category: ProductCategory;\r\n  onSelect: (asset: Asset) => void;\r\n  placeholder?: string;\r\n  className?: string;\r\n}> = ({ category, onSelect, placeholder = \"Search category assets\", className = \"\" }) => {\r\n  const [query, setQuery] = useState('');\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [results, setResults] = useState<Asset[]>([]);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (e: MouseEvent) => {\r\n      if (containerRef.current && !containerRef.current.contains(e.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const search = async () => {\r\n      if (query.length > 1) {\r\n        const matches = await searchAssets(query, category);\r\n        setResults(matches);\r\n      } else {\r\n        setResults([]);\r\n      }\r\n    };\r\n    search();\r\n  }, [query, category]);\r\n\r\n  const handleProvisional = async () => {\r\n    setIsSubmitting(true);\r\n    setError(null);\r\n    const res = await createProvisionalAsset({ query, category });\r\n    if (res.ok && res.asset) {\r\n      onSelect(res.asset);\r\n    } else {\r\n      setError(res.error || \"Failed to create provisional asset.\");\r\n    }\r\n    setIsSubmitting(false);\r\n  };\r\n\r\n  return (\r\n    <div className={`relative w-full ${className}`} ref={containerRef}>\r\n      <input\r\n        type=\"text\"\r\n        value={query}\r\n        onFocus={() => setIsOpen(true)}\r\n        onChange={(e) => setQuery(e.target.value)}\r\n        placeholder={placeholder}\r\n        className=\"w-full p-4 bg-white border border-slate-200 rounded-xl text-sm font-bold text-slate-900 outline-none focus:border-blue-600 transition-all\"\r\n      />\r\n\r\n      {isOpen && (\r\n        <div className=\"absolute top-full left-0 right-0 z-50 mt-1 bg-white border border-slate-200 rounded-xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-top-1\">\r\n          <div className=\"max-h-60 overflow-y-auto\">\r\n            {results.length > 0 ? (\r\n              results.map(a => (\r\n                <button\r\n                  key={a.id}\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    onSelect(a);\r\n                    setIsOpen(false);\r\n                  }}\r\n                  className=\"w-full p-4 text-left hover:bg-slate-50 flex items-center justify-between border-b border-slate-50 last:border-0 group\"\r\n                >\r\n                  <div>\r\n                    <span className=\"text-[9px] font-black text-slate-400 uppercase tracking-tighter mr-2\">{a.brand}</span>\r\n                    <span className=\"text-sm font-bold text-slate-900\">{a.model_name}</span>\r\n                  </div>\r\n                  <span className=\"text-[8px] font-black bg-emerald-50 text-emerald-600 px-1.5 py-0.5 rounded border border-emerald-100 uppercase group-hover:bg-emerald-500 group-hover:text-white transition-colors\">Indexed</span>\r\n                </button>\r\n              ))\r\n            ) : (\r\n              <div className=\"p-4 text-center\">\r\n                <p className=\"text-[10px] font-bold text-slate-300 uppercase italic\">\r\n                  {query.length > 1 ? \"Asset not indexed.\" : \"Enter search term...\"}\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n          {query.length > 2 && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleProvisional}\r\n              disabled={isSubmitting}\r\n              className=\"w-full p-3 bg-slate-50 border-t border-slate-100 text-[10px] font-black text-slate-400 uppercase tracking-widest hover:bg-amber-50 hover:text-amber-600 transition-all text-center\"\r\n            >\r\n              {isSubmitting ? 'Validating...' : '+ Add unverified asset'}\r\n            </button>\r\n          )}\r\n          {error && <div className=\"p-2 text-[9px] font-bold text-red-500 bg-red-50 text-center uppercase\">{error}</div>}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ComparisonPicker: React.FC = () => {\r\n  const [categories] = useState<Category[]>(listCategories());\r\n  const [selectedCategory, setSelectedCategory] = useState<ProductCategory>(() => {\r\n    // Check if window is defined (client-side)\r\n    if (typeof window !== 'undefined') {\r\n      return (sessionStorage.getItem('actual_fyi_last_category') as ProductCategory) || 'portable_power_station';\r\n    }\r\n    return 'portable_power_station';\r\n  });\r\n  const router = useRouter();\r\n\r\n  const handleCategoryChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\r\n    const val = e.target.value as ProductCategory;\r\n    setSelectedCategory(val);\r\n    sessionStorage.setItem('actual_fyi_last_category', val);\r\n  };\r\n\r\n  return (\r\n    <section className=\"w-full max-w-2xl mx-auto px-4\">\r\n      <div className=\"p-8 md:p-12 bg-white border border-slate-200 rounded-[2.5rem] shadow-sm\">\r\n        <h2 className=\"text-lg font-black uppercase tracking-tighter mb-8 text-slate-900 text-center\">Initiate Forensic Audit</h2>\r\n\r\n        <div className=\"flex flex-col gap-4\">\r\n          <div className=\"space-y-2\">\r\n            <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest ml-1\">Select Domain</label>\r\n            <select\r\n              value={selectedCategory}\r\n              onChange={handleCategoryChange}\r\n              className=\"w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-xl text-sm font-bold text-slate-900 outline-none focus:border-blue-600 transition-all appearance-none\"\r\n            >\r\n              {categories.map(c => <option key={c.id} value={c.id}>{c.label}</option>)}\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <label className=\"text-[9px] font-black text-slate-400 uppercase tracking-widest ml-1\">Search Asset</label>\r\n            <AssetSelector\r\n              category={selectedCategory}\r\n              onSelect={(asset) => router.push(`/specs/${asset.slug}?autoRun=true`)}\r\n              placeholder={`Search ${categories.find(c => c.id === selectedCategory)?.label}...`}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"flex justify-center gap-6 mt-8\">\r\n        <p className=\"text-[9px] font-black text-slate-300 uppercase tracking-widest flex items-center gap-2\">\r\n          <span className=\"w-1.5 h-1.5 bg-emerald-500 rounded-full\"></span> Forensic Ledger Active\r\n        </p>\r\n        <p className=\"text-[9px] font-black text-slate-300 uppercase tracking-widest flex items-center gap-2\">\r\n          <span className=\"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse\"></span> Cross-Category Protection On\r\n        </p>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default ComparisonPicker;\r\n","\"use client\";\r\n\r\nimport React, { Suspense } from 'react';\r\nimport Link from 'next/link';\r\nimport { usePathname, useSearchParams } from 'next/navigation';\r\n\r\ninterface LayoutProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nfunction NavContent() {\r\n  const pathname = usePathname();\r\n  const searchParams = useSearchParams();\r\n  const status = searchParams.get('status');\r\n  const isDetailPage = pathname.startsWith('/specs/') && pathname.split('/').length > 2;\r\n\r\n  return (\r\n    <nav className=\"sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-200\">\r\n      <div className=\"max-w-6xl mx-auto px-6 py-4 flex justify-between items-center\">\r\n        <Link href=\"/\" className=\"text-xl font-black uppercase tracking-tighter hover:text-blue-600 transition-colors\">\r\n          Actual<span className=\"text-blue-600\">.</span>fyi\r\n        </Link>\r\n        <div className=\"flex items-center gap-4 md:gap-8\">\r\n          <Link href=\"/specs?status=verified\" className={`text-[10px] font-black uppercase tracking-widest transition-colors ${status === 'verified' || (!status && !pathname.includes('status')) ? 'text-blue-600' : 'text-slate-500 hover:text-blue-600'}`}>\r\n            Ledger\r\n          </Link>\r\n          <Link href=\"/specs?status=provisional\" className={`text-[10px] font-black uppercase tracking-widest transition-colors ${status === 'provisional' ? 'text-amber-600' : 'text-slate-500 hover:text-amber-600'}`}>\r\n            Provisional\r\n          </Link>\r\n          {isDetailPage ? (\r\n            <Link href=\"/contribute\" className=\"hidden md:block text-[10px] font-black uppercase tracking-widest text-slate-400 hover:text-slate-600 transition-colors\">\r\n              New Audit\r\n            </Link>\r\n          ) : (\r\n            <Link href=\"/contribute\" className=\"text-[10px] font-black uppercase tracking-widest text-white bg-slate-900 px-4 py-2 rounded-lg hover:bg-blue-600 transition-all shadow-sm\">\r\n              Submit\r\n            </Link>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  );\r\n}\r\n\r\nconst Layout: React.FC<LayoutProps> = ({ children }) => {\r\n  return (\r\n    <div className=\"flex flex-col min-h-screen\">\r\n      <Suspense fallback={<div className=\"h-16 border-b border-slate-200\" />}>\r\n        <NavContent />\r\n      </Suspense>\r\n\r\n      <main className=\"flex-grow\">\r\n        {children}\r\n      </main>\r\n\r\n      <footer className=\"mt-20 border-t border-slate-200 bg-white py-12\">\r\n        <div className=\"max-w-4xl mx-auto px-6 text-center\">\r\n          <p className=\"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-4\">Transparency Disclosure</p>\r\n          <p className=\"text-xs text-slate-400 leading-relaxed italic\">\r\n            Independent technical audits. We prioritize technical reality over manufacturer marketing.\r\n          </p>\r\n          <div className=\"mt-8 flex flex-col sm:flex-row items-center justify-center gap-6\">\r\n            <p className=\"text-[10px] text-slate-300 font-bold uppercase\">&copy; 2026 Actual.fyi</p>\r\n            <div className=\"flex items-center gap-6\">\r\n              <Link href=\"/coverage\" className=\"text-[10px] text-slate-300 hover:text-blue-600 font-bold uppercase tracking-widest transition-colors underline decoration-slate-200 underline-offset-4\">Coverage</Link>\r\n              <Link href=\"/contact\" className=\"text-[10px] text-slate-300 hover:text-blue-600 font-bold uppercase tracking-widest transition-colors underline decoration-slate-200 underline-offset-4\">Contact</Link>\r\n              <Link href=\"/diagnostics\" className=\"text-[10px] text-slate-300 hover:text-emerald-600 font-bold uppercase tracking-widest transition-colors\">System Diagnostics</Link>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </footer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Layout;\r\n","import { createClient, SupabaseClient } from \"@supabase/supabase-js\";\r\nimport { Product, AuditResult, Category, Asset } from \"../types\";\r\n\r\n// --- Client-Side Helpers (Browser/UI) ---\r\n\r\n// Lazy-init singleton for client to avoid top-level side effects during server build\r\nlet _publicClient: SupabaseClient | null = null;\r\n\r\nfunction getPublicClient() {\r\n    if (_publicClient) return _publicClient;\r\n\r\n    // STRICT ENV ACCESS: Use NEXT_PUBLIC_ for client\r\n    const url = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\n    const key = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\r\n\r\n    if (!url || !key) {\r\n        console.warn(\"Missing Supabase Client Env (NEXT_PUBLIC_SUPABASE_URL / NEXT_PUBLIC_SUPABASE_ANON_KEY). Inventory will be empty.\");\r\n        // We throw to fail fast if config is wrong, as per previous requirement\r\n        throw new Error(\"Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY.\");\r\n    }\r\n\r\n    _publicClient = createClient(url, key);\r\n    return _publicClient;\r\n}\r\n\r\nexport const listCategories = (): Category[] => [\r\n    { id: 'portable_power_station', label: 'Portable Power Stations' },\r\n    { id: 'solar_generator_kit', label: 'Solar Generator Kits' },\r\n    { id: 'solar_panel', label: 'Solar Panels' },\r\n    { id: 'inverter', label: 'Inverters' },\r\n    { id: 'battery', label: 'Batteries' },\r\n    { id: 'charge_controller', label: 'Charge Controllers' },\r\n];\r\n\r\nexport const searchAssets = async (query: string, category: string = \"all\", brand: string = \"all\"): Promise<Asset[]> => {\r\n    try {\r\n        const client = getPublicClient();\r\n        let builder = client.from('products').select('*');\r\n\r\n        if (category !== \"all\") {\r\n            builder = builder.eq('category', category);\r\n        }\r\n\r\n        if (brand !== \"all\") {\r\n            builder = builder.eq('brand', brand);\r\n        }\r\n\r\n        if (query && query.trim().length > 0) {\r\n            builder = builder.ilike('model_name', `%${query}%`);\r\n        }\r\n\r\n        const { data } = await builder.limit(200);\r\n\r\n        if (!data) return [];\r\n\r\n        return data.map(d => ({\r\n            ...d,\r\n            verified: d.is_audited,\r\n            verification_status: d.is_audited ? 'verified' : 'provisional'\r\n        })) as Asset[];\r\n    } catch (e) {\r\n        console.warn(\"Supabase search failed:\", e);\r\n        return [];\r\n    }\r\n};\r\n\r\nexport const createProvisionalAsset = async (payload: any): Promise<{ ok: boolean; error?: string; asset?: Asset }> => {\r\n    return { ok: false, error: \"Asset creation is disabled in V1.\" };\r\n};\r\n\r\nexport const getAssetBySlug = async (slug: string): Promise<Asset | null> => {\r\n    try {\r\n        const client = getPublicClient();\r\n        const { data } = await client\r\n            .from('products')\r\n            .select('*')\r\n            .eq('slug', slug)\r\n            .maybeSingle();\r\n\r\n        if (!data) return null;\r\n\r\n        return {\r\n            ...data,\r\n            verified: data.is_audited,\r\n            verification_status: data.is_audited ? 'verified' : 'provisional'\r\n        } as Asset;\r\n    } catch (e) {\r\n        console.warn(\"Supabase fetch failed:\", e);\r\n        return null;\r\n    }\r\n};\r\n\r\nexport const getAllAssets = async (): Promise<Asset[]> => {\r\n    try {\r\n        const client = getPublicClient();\r\n        const { data } = await client\r\n            .from('products')\r\n            .select('*')\r\n            .limit(200);\r\n\r\n        if (!data) return [];\r\n\r\n        return data.map(d => ({\r\n            ...d,\r\n            verified: d.is_audited,\r\n            verification_status: d.is_audited ? 'verified' : 'provisional'\r\n        })) as Asset[];\r\n    } catch (e) {\r\n        console.warn(\"Supabase fetch failed:\", e);\r\n        return [];\r\n    }\r\n};\r\n\r\nexport const runAudit = async (payload: string | { slug: string, depth?: number }): Promise<AuditResult> => {\r\n    const slug = typeof payload === \"string\" ? payload : payload.slug;\r\n\r\n    if (!slug) throw new Error(\"Missing slug for audit\");\r\n\r\n    const resp = await fetch(\"/api/audit\", {\r\n        method: \"POST\",\r\n        headers: { \"content-type\": \"application/json\" },\r\n        body: JSON.stringify({ slug }),\r\n    });\r\n\r\n    const data = await resp.json();\r\n    if (!data.ok || !data.audit) {\r\n        throw new Error(data.error || \"Audit failed\");\r\n    }\r\n    return data.audit;\r\n};\r\n","import React from 'react';\r\nimport './globals.css';\r\nimport Layout from '@/components/Layout';\r\n\r\nexport const metadata = {\r\n    title: 'Actual.fyi | Forensic Power Station Audits',\r\n    description: 'Technical integrity verified against real-world discharge tests.',\r\n};\r\n\r\nexport default function RootLayout({\r\n    children,\r\n}: {\r\n    children: React.ReactNode;\r\n}) {\r\n    return (\r\n        <html lang=\"en\">\r\n            <body className=\"bg-white min-h-screen text-slate-900 selection:bg-blue-100 selection:text-blue-900\">\r\n                <Layout>{children}</Layout>\r\n            </body>\r\n        </html>\r\n    );\r\n}\r\n"],"names":["AssetSelector","category","onSelect","placeholder","className","query","setQuery","useState","isOpen","setIsOpen","results","setResults","isSubmitting","setIsSubmitting","error","setError","containerRef","useRef","useEffect","handleClickOutside","current","contains","e","target","document","addEventListener","removeEventListener","search","length","searchAssets","handleProvisional","res","createProvisionalAsset","ok","asset","div","ref","input","type","value","onFocus","onChange","map","a","button","onClick","span","brand","model_name","id","p","disabled","NavContent","pathname","usePathname","status","useSearchParams","get","isDetailPage","startsWith","split","nav","Link","href","includes","children","Layout","Suspense","fallback","main","footer","_publicClient","getPublicClient","url","process","env","NEXT_PUBLIC_SUPABASE_URL","key","NEXT_PUBLIC_SUPABASE_ANON_KEY","console","warn","createClient","builder","from","select","eq","trim","ilike","data","limit","d","verified","is_audited","verification_status","payload","getAssetBySlug","slug","client","maybeSingle","runAudit","resp","fetch","method","headers","body","JSON","stringify","json","audit","metadata","title","description","RootLayout","html","lang"],"sourceRoot":"","ignoreList":[]}